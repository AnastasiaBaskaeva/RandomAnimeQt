# Form implementation generated from reading ui file '.\SUPERrandomanime.ui'
#
# Created by: PyQt6 UI code generator 6.0.2
#
# WARNING: Any manual changes made to this file will be lost when pyuic6 is
# run again.  Do not edit this file unless you know what you are doing.


import requests
from PyQt6 import QtCore, QtGui, QtWidgets
from PyQt6.QtCore import QUrl
from PyQt6.QtGui import QPixmap,  QIcon
from PyQt6.QtNetwork import QNetworkRequest, QNetworkAccessManager
import pickle


class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.resize(858, 509)
        font = QtGui.QFont()
        font.setFamily("Snap ITC")
        font.setBold(False)
        font.setItalic(False)
        font.setUnderline(False)
        MainWindow.setFont(font)
        MainWindow.setCursor(QtGui.QCursor(QtCore.Qt.CursorShape.ArrowCursor))
        MainWindow.setMouseTracking(True)
        MainWindow.setAutoFillBackground(False)
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.verticalLayoutWidget = QtWidgets.QWidget(self.centralwidget)
        self.verticalLayoutWidget.setGeometry(QtCore.QRect(60, 170, 161, 131))
        self.verticalLayoutWidget.setObjectName("verticalLayoutWidget")
        self.verticalLayout = QtWidgets.QVBoxLayout(self.verticalLayoutWidget)
        self.verticalLayout.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout.setObjectName("verticalLayout")
        self.genre = QtWidgets.QComboBox(self.verticalLayoutWidget)
        self.genre.setCursor(QtGui.QCursor(QtCore.Qt.CursorShape.PointingHandCursor))
        self.genre.setObjectName("genre")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.genre.addItem("")
        self.verticalLayout.addWidget(self.genre)
        self.year = QtWidgets.QLineEdit(self.verticalLayoutWidget)
        font = QtGui.QFont()
        font.setFamily("Arial")
        font.setBold(False)
        font.setItalic(False)
        font.setUnderline(False)
        self.year.setFont(font)
        self.year.setObjectName("year")
        self.verticalLayout.addWidget(self.year)
        self.count = QtWidgets.QLineEdit(self.verticalLayoutWidget)
        font = QtGui.QFont()
        font.setFamily("Arial")
        font.setBold(False)
        font.setItalic(False)
        font.setUnderline(False)
        self.count.setFont(font)
        self.count.setObjectName("count")
        self.verticalLayout.addWidget(self.count)
        self.whatsee = QtWidgets.QLabel(self.centralwidget)
        self.whatsee.setGeometry(QtCore.QRect(40, 120, 201, 41))
        font = QtGui.QFont()
        font.setFamily("Arial Black")
        font.setPointSize(12)
        font.setBold(True)
        font.setItalic(False)
        font.setUnderline(False)
        self.whatsee.setFont(font)
        self.whatsee.setObjectName("whatsee")
        self.findbutton = QtWidgets.QPushButton(self.centralwidget)
        self.findbutton.setGeometry(QtCore.QRect(90, 320, 101, 41))
        font = QtGui.QFont()
        font.setFamily("Arial Black")
        font.setPointSize(11)
        font.setBold(True)
        font.setItalic(False)
        font.setUnderline(False)
        self.findbutton.setFont(font)
        self.findbutton.setCursor(QtGui.QCursor(QtCore.Qt.CursorShape.PointingHandCursor))
        self.findbutton.setObjectName("findbutton")
        self.poster = QtWidgets.QLabel(self.centralwidget)
        self.poster.setGeometry(QtCore.QRect(620, 110, 201, 291))
        self.poster.setText("")
        self.poster.setObjectName("poster")
        self.verticalLayoutWidget_2 = QtWidgets.QWidget(self.centralwidget)
        self.verticalLayoutWidget_2.setGeometry(QtCore.QRect(290, 110, 311, 291))
        self.verticalLayoutWidget_2.setObjectName("verticalLayoutWidget_2")
        self.verticalLayout_2 = QtWidgets.QVBoxLayout(self.verticalLayoutWidget_2)
        self.verticalLayout_2.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout_2.setObjectName("verticalLayout_2")
        self.label_title = QtWidgets.QLabel(self.verticalLayoutWidget_2)
        font = QtGui.QFont()
        font.setFamily("System")
        font.setPointSize(15)
        font.setBold(True)
        font.setItalic(False)
        font.setUnderline(False)
        self.label_title.setFont(font)
        self.label_title.setLayoutDirection(QtCore.Qt.LayoutDirection.LeftToRight)
        self.label_title.setObjectName("label_title")
        self.verticalLayout_2.addWidget(self.label_title)
        self.label_year = QtWidgets.QLabel(self.verticalLayoutWidget_2)
        font = QtGui.QFont()
        font.setFamily("System")
        font.setPointSize(15)
        font.setBold(True)
        font.setItalic(False)
        font.setUnderline(False)
        self.label_year.setFont(font)
        self.label_year.setObjectName("label_year")
        self.verticalLayout_2.addWidget(self.label_year)
        self.label_count = QtWidgets.QLabel(self.verticalLayoutWidget_2)
        font = QtGui.QFont()
        font.setFamily("System")
        font.setPointSize(15)
        font.setBold(True)
        font.setItalic(False)
        font.setUnderline(False)
        self.label_count.setFont(font)
        self.label_count.setObjectName("label_count")
        self.verticalLayout_2.addWidget(self.label_count)
        self.label_va = QtWidgets.QLabel(self.verticalLayoutWidget_2)
        font = QtGui.QFont()
        font.setFamily("System")
        font.setPointSize(15)
        font.setBold(True)
        font.setItalic(False)
        font.setUnderline(False)
        self.label_va.setFont(font)
        self.label_va.setObjectName("label_va")
        self.verticalLayout_2.addWidget(self.label_va)
        self.label_genre = QtWidgets.QLabel(self.verticalLayoutWidget_2)
        font = QtGui.QFont()
        font.setFamily("System")
        font.setPointSize(15)
        font.setBold(True)
        font.setItalic(False)
        font.setUnderline(False)
        self.label_genre.setFont(font)
        self.label_genre.setObjectName("label_genre")
        self.verticalLayout_2.addWidget(self.label_genre)
        self.addbutton = QtWidgets.QPushButton(self.centralwidget)
        self.addbutton.setGeometry(QtCore.QRect(310, 430, 31, 31))
        font = QtGui.QFont()
        font.setFamily("Arial Black")
        font.setBold(True)
        font.setItalic(False)
        font.setUnderline(False)
        self.addbutton.setFont(font)
        self.addbutton.setCursor(QtGui.QCursor(QtCore.Qt.CursorShape.PointingHandCursor))
        self.addbutton.setObjectName("addbutton")
        self.line = QtWidgets.QFrame(self.centralwidget)
        self.line.setGeometry(QtCore.QRect(270, 60, 20, 421))
        font = QtGui.QFont()
        font.setFamily("System")
        font.setPointSize(16)
        font.setBold(True)
        font.setItalic(False)
        font.setUnderline(False)
        self.line.setFont(font)
        self.line.setFrameShape(QtWidgets.QFrame.Shape.VLine)
        self.line.setFrameShadow(QtWidgets.QFrame.Shadow.Sunken)
        self.line.setObjectName("line")
        self.label = QtWidgets.QLabel(self.centralwidget)
        self.label.setGeometry(QtCore.QRect(300, 10, 271, 41))
        font = QtGui.QFont()
        font.setFamily("Bauhaus 93")
        font.setPointSize(28)
        font.setBold(False)
        font.setItalic(False)
        font.setUnderline(False)
        self.label.setFont(font)
        self.label.setObjectName("label")
        self.line_2 = QtWidgets.QFrame(self.centralwidget)
        self.line_2.setGeometry(QtCore.QRect(10, 50, 871, 20))
        self.line_2.setFrameShape(QtWidgets.QFrame.Shape.HLine)
        self.line_2.setFrameShadow(QtWidgets.QFrame.Shadow.Sunken)
        self.line_2.setObjectName("line_2")
        self.line_3 = QtWidgets.QFrame(self.centralwidget)
        self.line_3.setGeometry(QtCore.QRect(260, 60, 20, 421))
        self.line_3.setFrameShape(QtWidgets.QFrame.Shape.VLine)
        self.line_3.setFrameShadow(QtWidgets.QFrame.Shadow.Sunken)
        self.line_3.setObjectName("line_3")
        self.line_4 = QtWidgets.QFrame(self.centralwidget)
        self.line_4.setGeometry(QtCore.QRect(610, 110, 20, 291))
        self.line_4.setFrameShape(QtWidgets.QFrame.Shape.VLine)
        self.line_4.setFrameShadow(QtWidgets.QFrame.Shadow.Sunken)
        self.line_4.setObjectName("line_4")
        self.line_5 = QtWidgets.QFrame(self.centralwidget)
        self.line_5.setGeometry(QtCore.QRect(810, 110, 20, 291))
        self.line_5.setFrameShape(QtWidgets.QFrame.Shape.VLine)
        self.line_5.setFrameShadow(QtWidgets.QFrame.Shadow.Sunken)
        self.line_5.setObjectName("line_5")
        self.line_6 = QtWidgets.QFrame(self.centralwidget)
        self.line_6.setGeometry(QtCore.QRect(620, 390, 201, 20))
        self.line_6.setFrameShape(QtWidgets.QFrame.Shape.HLine)
        self.line_6.setFrameShadow(QtWidgets.QFrame.Shadow.Sunken)
        self.line_6.setObjectName("line_6")
        self.line_7 = QtWidgets.QFrame(self.centralwidget)
        self.line_7.setGeometry(QtCore.QRect(620, 100, 201, 20))
        self.line_7.setFrameShape(QtWidgets.QFrame.Shape.HLine)
        self.line_7.setFrameShadow(QtWidgets.QFrame.Shadow.Sunken)
        self.line_7.setObjectName("line_7")
        self.line_8 = QtWidgets.QFrame(self.centralwidget)
        self.line_8.setGeometry(QtCore.QRect(10, 470, 891, 31))
        self.line_8.setFrameShape(QtWidgets.QFrame.Shape.HLine)
        self.line_8.setFrameShadow(QtWidgets.QFrame.Shadow.Sunken)
        self.line_8.setObjectName("line_8")
        self.gotofavouriteButton = QtWidgets.QPushButton(self.centralwidget)
        self.gotofavouriteButton.setGeometry(QtCore.QRect(360, 430, 131, 31))
        font = QtGui.QFont()
        font.setFamily("Arial")
        font.setBold(True)
        font.setItalic(False)
        font.setUnderline(False)
        self.gotofavouriteButton.setFont(font)
        self.gotofavouriteButton.setObjectName("gotofavouriteButton")
        self.line_9 = QtWidgets.QFrame(self.centralwidget)
        self.line_9.setGeometry(QtCore.QRect(-10, 60, 41, 421))
        self.line_9.setFrameShape(QtWidgets.QFrame.Shape.VLine)
        self.line_9.setFrameShadow(QtWidgets.QFrame.Shadow.Sunken)
        self.line_9.setObjectName("line_9")
        MainWindow.setCentralWidget(self.centralwidget)
        self.statusbar = QtWidgets.QStatusBar(MainWindow)
        self.statusbar.setObjectName("statusbar")
        MainWindow.setStatusBar(self.statusbar)
        self.action = QtWidgets.QWidgetAction(MainWindow)
        self.action.setObjectName("action")
        self.action_favouriteopen = QtWidgets.QWidgetAction(MainWindow)
        self.action_favouriteopen.setObjectName("action_favouriteopen")

        self.retranslateUi(MainWindow)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

        self.findbutton.clicked.connect(self.functions)
        self.sender = QNetworkAccessManager()
        self.sender.finished.connect(self.setImg)

        self.addbutton.clicked.connect(self.favourite)

        self.favouriteS = []
        self.lastanime = {}

        with open('favourite.txt', 'rb') as h:
            try:
                self.favouriteS = pickle.loads(h.read())

            except EOFError:
                self.favouriteS = []
        print(self.favouriteS)

    def functions(self):
        url = 'https://anime777.ru/api/rand'
        response = requests.get(url)
        choise = {"genre": self.genre.currentText(),
                  "year": self.year.text(),
                  "episodes_total": self.count.text()}
        response.raise_for_status()
        try:
            response = requests.get(url, params=choise)
            json = response.json()
        except:
            print("kjhg")

        try:
            self.label_title.setText(response.json()['title'])
            self.label_year.setText(str(response.json()['year']))
            self.label_va.setText(response.json()['translate'])
            self.label_count.setText(str(response.json()['material_data']['episodes_total']))
            self.label_genre.setText(str(response.json()['material_data']['all_genres'][0:3]).replace("[", "").replace("]", "").replace("'",""))

            urlImg = str(response.json()['material_data']["poster_url"])
            self.sender.get(QNetworkRequest(QUrl(urlImg)))
            self.lastanime = response.json()
        except:
            font = QtGui.QFont()
            font.setPointSize(14)
            font.setBold(True)
            self.poster.setFont(font)
            self.poster.setStyleSheet("color: rgb(170, 0, 0);\n"
                                      "border-color: rgb(85, 170, 255);")
            self.poster.setText("Мы не нашли\nничего \n"
                                "похожего :(")

    def setImg(self, reply):
        img = QPixmap()
        img.loadFromData(reply.readAll())
        self.poster.setPixmap(img)

    def favourite(self):
        if self.lastanime != {}:
            if self.lastanime not in self.favouriteS:
                with open('favourite.txt', 'wb') as f:
                    self.favouriteS.append(self.lastanime)
                    pickle.dump(self.favouriteS, f)
                print(self.lastanime)
                print(self.favouriteS)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "RandomAnime"))
        self.genre.setItemText(0, _translate("MainWindow", "Жанр"))
        self.genre.setItemText(1, _translate("MainWindow", "Безумие"))
        self.genre.setItemText(2, _translate("MainWindow", "Боевые искусства"))
        self.genre.setItemText(3, _translate("MainWindow", "Вампиры"))
        self.genre.setItemText(4, _translate("MainWindow", "Гарем"))
        self.genre.setItemText(5, _translate("MainWindow", "Демоны"))
        self.genre.setItemText(6, _translate("MainWindow", "Детектив"))
        self.genre.setItemText(7, _translate("MainWindow", "Детское"))
        self.genre.setItemText(8, _translate("MainWindow", "Дзёсей"))
        self.genre.setItemText(9, _translate("MainWindow", "Драма"))
        self.genre.setItemText(10, _translate("MainWindow", "Игры"))
        self.genre.setItemText(11, _translate("MainWindow", "Исторический"))
        self.genre.setItemText(12, _translate("MainWindow", "Комедия"))
        self.genre.setItemText(13, _translate("MainWindow", "Космос"))
        self.genre.setItemText(14, _translate("MainWindow", "Магия"))
        self.genre.setItemText(15, _translate("MainWindow", "Машины"))
        self.genre.setItemText(16, _translate("MainWindow", "Меха"))
        self.genre.setItemText(17, _translate("MainWindow", "Музыка"))
        self.genre.setItemText(18, _translate("MainWindow", "Пародия"))
        self.genre.setItemText(19, _translate("MainWindow", "Повседневность"))
        self.genre.setItemText(20, _translate("MainWindow", "Полиция"))
        self.genre.setItemText(21, _translate("MainWindow", "Приключения"))
        self.genre.setItemText(22, _translate("MainWindow", "Психологическое"))
        self.genre.setItemText(23, _translate("MainWindow", "Романтика"))
        self.genre.setItemText(24, _translate("MainWindow", "Самураи"))
        self.genre.setItemText(25, _translate("MainWindow", "Сверхъестесственное"))
        self.genre.setItemText(26, _translate("MainWindow", "Сейнен"))
        self.genre.setItemText(27, _translate("MainWindow", "Спорт"))
        self.genre.setItemText(28, _translate("MainWindow", "Супер сила"))
        self.genre.setItemText(29, _translate("MainWindow", "Сёдзе"))
        self.genre.setItemText(30, _translate("MainWindow", "Сёдзе-ай"))
        self.genre.setItemText(31, _translate("MainWindow", "Сёнен"))
        self.genre.setItemText(32, _translate("MainWindow", "Сёнен-ай"))
        self.genre.setItemText(33, _translate("MainWindow", "Триллер"))
        self.genre.setItemText(34, _translate("MainWindow", "Ужасы"))
        self.genre.setItemText(35, _translate("MainWindow", "Фантастика"))
        self.genre.setItemText(36, _translate("MainWindow", "Фентези"))
        self.genre.setItemText(37, _translate("MainWindow", "Школа"))
        self.genre.setItemText(38, _translate("MainWindow", "Экшен"))
        self.genre.setItemText(39, _translate("MainWindow", "Этти"))
        self.genre.setItemText(40, _translate("MainWindow", "Яой"))
        self.year.setText(_translate("MainWindow", "Год"))
        self.count.setText(_translate("MainWindow", "Количество серий"))
        self.whatsee.setText(_translate("MainWindow", "Что будем смотреть?"))
        self.findbutton.setText(_translate("MainWindow", "Найти!"))
        self.label_title.setText(_translate("MainWindow", "Название:"))
        self.label_year.setText(_translate("MainWindow", "Год:"))
        self.label_count.setText(_translate("MainWindow", "Количество серий:"))
        self.label_va.setText(_translate("MainWindow", "Озвучка:"))
        self.label_genre.setText(_translate("MainWindow", "Жанры:"))
        self.addbutton.setText(_translate("MainWindow", "★"))
        self.label.setText(_translate("MainWindow", "RANDOM ANIME"))
        self.gotofavouriteButton.setText(_translate("MainWindow", "Перейти в избанное"))
        self.action.setText(_translate("MainWindow", "Открыть избранное"))
        self.action_favouriteopen.setText(_translate("MainWindow", "Открыть"))


if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    MainWindow = QtWidgets.QMainWindow()
    ui = Ui_MainWindow()
    ui.setupUi(MainWindow)
    MainWindow.show()
    sys.exit(app.exec())
